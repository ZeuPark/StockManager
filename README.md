# StockManager

## Intraday Stock Trading & Backtesting System

**Author:** Zeu Park  
**Email:** parkzeu68

---

StockManager is a Python-based framework for real-time intraday trading and strategy backtesting, designed for the Korean stock market. It features event-driven backtesting, advanced analytics, and a robust real-time trading engine. This project is ideal for portfolio demonstration, showcasing both algorithmic trading and quantitative research skills.

---

## ğŸš€ Key Features

### 1. Real-Time Trading System
- **WebSocket-based real-time data streaming**
- **Automated order execution** based on strategy signals
- **Live risk management** (position sizing, stop-loss, trailing stop)
- **API integration** with Korea Investment & Securities

### 2. Strategy Backtesting
- **Event-driven backtesting** using 1-minute bar data
- **Multiple strategies supported** (e.g., Gap and Go, Trend Following)
- **Dynamic risk management** (trailing stop, position sizing)
- **Market regime filter** based on KOSPI index
- **Realistic trading cost modeling** (commission, tax, slippage)

### 3. Advanced Analytics
- **Walk-forward optimization** to prevent overfitting
- **Parameter sensitivity analysis**
- **Batch backtesting** for robustness
- **Performance monitoring** (real-time and historical)

---

## ğŸ“ Project Structure

```
StockManager/
â”œâ”€â”€ main.py                  # Entry point for CLI and orchestration
â”œâ”€â”€ account/                 # Account monitoring and management modules
â”œâ”€â”€ analysis/                # Strategy analytics, visualization, and batch analysis
â”œâ”€â”€ api/                     # API clients for brokerage and data (REST, WebSocket)
â”œâ”€â”€ config/                  # Project-wide configuration and settings
â”œâ”€â”€ core/                    # Core trading logic, backtesting, optimization, and real-time engine
â”œâ”€â”€ data_collection/         # Data collection scripts and market data utilities
â”œâ”€â”€ database/                # Database schema, initialization, and management
â”œâ”€â”€ deployment/              # Docker and deployment configs
â”œâ”€â”€ docs/                    # Documentation, strategy guides, and flow diagrams
â”œâ”€â”€ logs/                    # Log files (auto-generated)
â”œâ”€â”€ minute_data/             # 1-minute bar data storage (external or generated)
â”œâ”€â”€ monitor/                 # Real-time monitoring, metrics, and alerting
â”œâ”€â”€ monitoring/              # Prometheus and monitoring configs
â”œâ”€â”€ news_trading/            # News-based trading strategies and crawlers
â”œâ”€â”€ nginx/                   # Nginx reverse proxy configuration
â”œâ”€â”€ orders/                  # Order management and signal processing
â”œâ”€â”€ tests/                   # Unit and integration tests
â”œâ”€â”€ trading/                 # Trading simulators and strategy runners
â”œâ”€â”€ utils/                   # Utility modules (indicators, logging, tokens)
â””â”€â”€ requirements.txt         # Python dependencies
```

### Directory Descriptions

- **main.py**: Unified entry point for running backtests, real-time trading, or utilities.
- **account/**: Account monitoring, balance tracking, and account-related utilities.
- **analysis/**: Tools for analyzing strategies, visualizing results, and running batch analytics.
- **api/**: Interfaces for connecting to brokerage APIs (REST/WebSocket) and data providers.
- **config/**: Centralized configuration files and settings for the project.
- **core/**: Core trading engine, backtesting logic, parameter optimization, and real-time trading modules.
- **data_collection/**: Scripts and modules for collecting historical and real-time market data.
- **database/**: Database schema, initialization scripts, and management utilities for storing trades and analytics.
- **deployment/**: Docker and deployment-related configuration for production or cloud environments.
- **docs/**: Documentation, strategy explanations, project flowcharts, and example results.
- **logs/**: Directory for log outputs (created automatically during runs).
- **minute_data/**: Storage for 1-minute bar data (external or generated by data collectors).
- **monitor/**: Real-time monitoring scripts, Prometheus metrics exporters, and alerting tools.
- **monitoring/**: Prometheus and monitoring configuration files.
- **news_trading/**: News-based trading strategies, crawlers, and related backtesting tools.
- **nginx/**: Nginx configuration for reverse proxying dashboards or APIs.
- **orders/**: Order management, signal processing, and execution logic.
- **tests/**: Unit and integration tests for all major modules.
- **trading/**: Trading simulators and strategy execution scripts.
- **utils/**: Utility functions, technical indicators, logging, and token management.
- **requirements.txt**: List of Python dependencies for the project.

---

## ğŸ› ï¸ Technical Stack & Implementation Details

### 1. **Python ê¸°ë°˜ ì•„í‚¤í…ì²˜**
- **ì£¼ ì–¸ì–´:** Python 3.x  
  ë°ì´í„° ë¶„ì„, ì‹¤ì‹œê°„ ì²˜ë¦¬, ë°±í…ŒìŠ¤íŠ¸, API ì—°ë™ ë“± ì „ ì˜ì—­ì— í™œìš©

### 2. **ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬**
- **WebSocket í´ë¼ì´ì–¸íŠ¸:**  
  ì‹¤ì‹œê°„ ì‹œì„¸ ë°ì´í„° ìˆ˜ì‹  ë° ì´ë²¤íŠ¸ ê¸°ë°˜ íŠ¸ë ˆì´ë”© ì‹ í˜¸ ì²˜ë¦¬  
  `api/websocket_client.py`ì—ì„œ ë¹„ë™ê¸° WebSocket í†µì‹  êµ¬í˜„
- **REST API ì—°ë™:**  
  ì¦ê¶Œì‚¬ API(ì˜ˆ: í•œêµ­íˆ¬ìì¦ê¶Œ)ì™€ì˜ í†µì‹ ì„ ìœ„í•œ REST í´ë¼ì´ì–¸íŠ¸  
  ì£¼ë¬¸, ì”ê³ ì¡°íšŒ, ì²´ê²°ë‚´ì—­ ë“± ì‹¤ì‹œê°„/ë¹„ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬

### 3. **ì´ë²¤íŠ¸ ê¸°ë°˜ íŠ¸ë ˆì´ë”© ì—”ì§„**
- **Event-driven Architecture:**  
  ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹  â†’ ì‹ í˜¸ ìƒì„± â†’ ì£¼ë¬¸ ì‹¤í–‰ â†’ í¬ì§€ì…˜ ê´€ë¦¬ì˜ ì¼ë ¨ì˜ íë¦„ì„ ì´ë²¤íŠ¸ë¡œ ì²˜ë¦¬  
  `core/real_time_trading.py` ë“±ì—ì„œ êµ¬í˜„

### 4. **ì „ëµ ë°±í…ŒìŠ¤íŒ… ë° ìµœì í™”**
- **1ë¶„ë´‰ ë°ì´í„° ê¸°ë°˜ ë°±í…ŒìŠ¤íŠ¸:**  
  `core/backtest_gradual_riser.py` ë“±ì—ì„œ 1ë¶„ ë‹¨ìœ„ë¡œ ì „ëµ ì„±ê³¼ í‰ê°€
- **Walk-forward Optimization:**  
  ê³¼ìµœì í™” ë°©ì§€ë¥¼ ìœ„í•œ êµ¬ê°„ë³„ ìµœì í™” ë° ê²€ì¦  
  `core/parameter_optimizer.py`ì—ì„œ êµ¬í˜„
- **Batch Backtesting:**  
  ë‹¤ì–‘í•œ íŒŒë¼ë¯¸í„°/ì „ëµ ì¡°í•©ì„ ë°˜ë³µì ìœ¼ë¡œ í‰ê°€

### 5. **ê³ ê¸‰ ë¶„ì„ ë° ì‹œê°í™”**
- **ì „ëµ ì„±ê³¼ ë¶„ì„:**  
  ìˆ˜ìµë¥ , MDD, ìƒ¤í”„ì§€ìˆ˜ ë“± ë‹¤ì–‘í•œ ì§€í‘œ ì‚°ì¶œ  
  `analysis/analysis_visualizer.py` ë“±ì—ì„œ ì‹œê°í™” ì§€ì›
- **íŒŒë¼ë¯¸í„° ë¯¼ê°ë„ ë¶„ì„:**  
  ì „ëµ íŒŒë¼ë¯¸í„° ë³€í™”ì— ë”°ë¥¸ ì„±ê³¼ ë¯¼ê°ë„ ë¶„ì„

### 6. **ë¦¬ìŠ¤í¬ ë° í¬ì§€ì…˜ ê´€ë¦¬**
- **ìë™ í¬ì§€ì…˜ ì‚¬ì´ì§•, ì†ì ˆ/ìµì ˆ, íŠ¸ë ˆì¼ë§ ìŠ¤íƒ‘**  
  ì‹¤ì‹œê°„ ë° ë°±í…ŒìŠ¤íŠ¸ ëª¨ë‘ì—ì„œ ì ìš©
- **ì‹œì¥ í•„í„°ë§:**  
  KOSPI ë“± ì‹œì¥ì§€ìˆ˜ ê¸°ë°˜ ë§¤ë§¤ í•„í„°ë§

### 7. **ë°ì´í„° ìˆ˜ì§‘ ë° ê´€ë¦¬**
- **ìë™ ë°ì´í„° ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸:**  
  `data_collection/` ë‚´ ë‹¤ì–‘í•œ ìˆ˜ì§‘ê¸°
- **DB ê´€ë¦¬:**  
  SQLite ë“± ê²½ëŸ‰ DBë¥¼ í†µí•œ ê±°ë˜/ë¶„ì„ ë°ì´í„° ì €ì¥  
  `database/` ë‚´ ìŠ¤í‚¤ë§ˆ ë° ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸

### 8. **ëª¨ë“ˆí™” ë° í™•ì¥ì„±**
- **í´ë”ë³„ ì—­í•  ë¶„ë¦¬:**  
  ì „ëµ, ë°ì´í„°, ì£¼ë¬¸, ëª¨ë‹ˆí„°ë§, ìœ í‹¸ë¦¬í‹° ë“± ê¸°ëŠ¥ë³„ ë””ë ‰í„°ë¦¬ êµ¬ì¡°
- **ìœ ë‹›/í†µí•© í…ŒìŠ¤íŠ¸:**  
  `tests/` ë‚´ ì£¼ìš” ê¸°ëŠ¥ë³„ í…ŒìŠ¤íŠ¸ ì½”ë“œ

### 9. **ìš´ì˜ ë° ë°°í¬**
- **Docker ê¸°ë°˜ ë°°í¬:**  
  `deployment/` ë‚´ Dockerfile, docker-composeë¡œ ì†ì‰¬ìš´ í™˜ê²½ êµ¬ì¶•
- **Nginx Reverse Proxy:**  
  ëŒ€ì‹œë³´ë“œ/ëª¨ë‹ˆí„°ë§ ì„œë¹„ìŠ¤ í”„ë¡ì‹œ ì§€ì›

### 10. **ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…**
- **Prometheus Metrics Exporter:**  
  ì‹¤ì‹œê°„ ì§€í‘œ ìˆ˜ì§‘ ë° ì™¸ë¶€ ëª¨ë‹ˆí„°ë§ ì—°ë™
- **ë¡œê¹… ì‹œìŠ¤í…œ:**  
  `utils/logger.py` ë“±ì—ì„œ ë¡œê·¸ ê´€ë¦¬

---

## ğŸ› ï¸ Installation

1. **Clone the repository:**
```bash
git clone https://github.com/yourusername/StockManager.git
cd StockManager
```

2. **Install dependencies:**
```bash
pip install -r requirements.txt
```

3. **Prepare data:**
- Collect 1-minute bar data and KOSPI index data using provided scripts in `data_collection/`.

4. **Configure API (for live trading):**
- Edit `api_config.json` with your API credentials.

---

## ğŸ“Š Usage Examples

### 1. Run a Basic Backtest
```bash
python backtest_gradual_riser.py
```

### 2. Batch Backtesting
```bash
python multi_experiment.py --repeat 10
```

### 3. Walk-Forward Optimization
```bash
python parameter_optimizer.py --walk-forward
```

### 4. Real-Time Trading
```bash
python core/real_time_trading.py
```

---

## ğŸ“ˆ Example Results

### Backtest Performance Graph
![Backtest Example](docs/example_backtest_result.png)

### Real-Time Trading Dashboard (Sample)
![Real-Time Dashboard](docs/example_realtime_dashboard.png)

*If you need actual result images, place your PNG/JPG files in the `docs/` folder and update the links above.*

---

## ğŸ§  Strategies Overview

### Gap and Go
- **Goal:** Capture early-morning momentum from opening price gaps and volume spikes
- **Logic:**
  - Opening gap > 0.2%
  - Volume > 30,000 shares at 9:00
  - Below 20-day moving average at open

### Trend Following
- **Goal:** Enter after intraday trend is established
- **Logic:**
  - Price up > 1% from open
  - MA5 > MA20 (golden cross)
  - Volume ratio > 80%

---

## âš™ï¸ Configuration Example

Edit `config/settings.py` for key parameters:
```python
CONFIG = {
    'initial_capital': 10000000,  # Starting capital (KRW)
    'max_positions': 2,           # Max concurrent positions
    'position_size': 1000000,     # Per-position size
    'stop_loss': -2.0,            # Stop loss (%)
    'take_profit': 5.0,           # Take profit (%)
    'trailing_stop': 3.0,         # Trailing stop (%)
    'commission_rate': 0.015,     # Commission (%)
    'tax_rate': 0.18,             # Tax (%)
    'slippage_rate': 0.05,        # Slippage (%)
    'enable_market_filter': True, # Use market regime filter
}
```

---

## ğŸ§ª Testing

Run all tests:
```bash
pytest tests/
```

---

## ğŸ“š Documentation
- Each module and function includes docstrings for clarity.
- See `docs/` for strategy explanations and checklists.

---

## ğŸ“ License

This project is licensed under the MIT License.

---

## ğŸ“¬ Contact

For questions or collaboration, contact:
- **Name:** Zeu Park
- **Email:** parkzeu68

---

**âš ï¸ Disclaimer:** This system is for educational and research purposes only. Use at your own risk. Always validate strategies thoroughly before live trading. 